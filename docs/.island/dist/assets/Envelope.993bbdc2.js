import{A as se,O as re}from"./index.6eef3859.js";import*as h from"react";import{forwardRef as Ee,useImperativeHandle as we,useRef as Z,useState as te,useMemo as I,useEffect as ae}from"react";import{jsx as n,jsxs as V}from"react/jsx-runtime";import{B as ce}from"./index.9726f765.js";import{c as me}from"./CodeBlock.d8e569ad.js";import{d as Ce,l as de}from"./transform.3e3dfeca.js";import{f as v,c as he,U as le,A as Me,a as N}from"./index.105c25bf.js";import{s as Re}from"./index.93441784.js";import{u as Ae,l as Te}from"./line.c32ceb13.js";import{s as Y}from"./log.83f32a09.js";import{K as M}from"./index.17ca28bf.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=me("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=me("Hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0",key:"aigmz7"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2",key:"1n6bmn"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8",key:"a9iiix"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);function Ne(t){let o;for(;o=t.sourceEvent;)t=o;return t}function fe(t,o){if(t=Ne(t),o===void 0&&(o=t.currentTarget),o){var r=o.ownerSVGElement||o;if(r.createSVGPoint){var s=r.createSVGPoint();return s.x=t.clientX,s.y=t.clientY,s=s.matrixTransform(o.getScreenCTM().inverse()),[s.x,s.y]}if(o.getBoundingClientRect){var x=o.getBoundingClientRect();return[t.clientX-x.left-o.clientLeft,t.clientY-x.top-o.clientTop]}}return[t.pageX,t.pageY]}const Pe={passive:!1},K={capture:!0,passive:!1};function ne(t){t.stopImmediatePropagation()}function G(t){t.preventDefault(),t.stopImmediatePropagation()}function He(t){var o=t.document.documentElement,r=Y(t).on("dragstart.drag",G,K);"onselectstart"in o?r.on("selectstart.drag",G,K):(o.__noselect=o.style.MozUserSelect,o.style.MozUserSelect="none")}function Ie(t,o){var r=t.document.documentElement,s=Y(t).on("dragstart.drag",null);o&&(s.on("click.drag",G,K),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in r?s.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const J=t=>()=>t;function oe(t,{sourceEvent:o,subject:r,target:s,identifier:x,active:p,x:w,y:b,dx:R,dy:g,dispatch:D}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:o,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:x,enumerable:!0,configurable:!0},active:{value:p,enumerable:!0,configurable:!0},x:{value:w,enumerable:!0,configurable:!0},y:{value:b,enumerable:!0,configurable:!0},dx:{value:R,enumerable:!0,configurable:!0},dy:{value:g,enumerable:!0,configurable:!0},_:{value:D}})}oe.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function je(t){return!t.ctrlKey&&!t.button}function ze(){return this.parentNode}function Oe(t,o){return o==null?{x:t.x,y:t.y}:o}function We(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ue(){var t=je,o=ze,r=Oe,s=We,x={},p=Ce("start","drag","end"),w=0,b,R,g,D,k=0;function u(e){e.on("mousedown.drag",P).filter(s).on("touchstart.drag",X).on("touchmove.drag",i,Pe).on("touchend.drag touchcancel.drag",O).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function P(e,l){if(!(D||!t.call(this,e,l))){var f=U(this,o.call(this,e,l),e,l,"mouse");!f||(Y(e.view).on("mousemove.drag",m,K).on("mouseup.drag",T,K),He(e.view),ne(e),g=!1,b=e.clientX,R=e.clientY,f("start",e))}}function m(e){if(G(e),!g){var l=e.clientX-b,f=e.clientY-R;g=l*l+f*f>k}x.mouse("drag",e)}function T(e){Y(e.view).on("mousemove.drag mouseup.drag",null),Ie(e.view,g),G(e),x.mouse("end",e)}function X(e,l){if(!!t.call(this,e,l)){var f=e.changedTouches,S=o.call(this,e,l),E=f.length,y,B;for(y=0;y<E;++y)(B=U(this,S,e,l,f[y].identifier,f[y]))&&(ne(e),B("start",e,f[y]))}}function i(e){var l=e.changedTouches,f=l.length,S,E;for(S=0;S<f;++S)(E=x[l[S].identifier])&&(G(e),E("drag",e,l[S]))}function O(e){var l=e.changedTouches,f=l.length,S,E;for(D&&clearTimeout(D),D=setTimeout(function(){D=null},500),S=0;S<f;++S)(E=x[l[S].identifier])&&(ne(e),E("end",e,l[S]))}function U(e,l,f,S,E,y){var B=p.copy(),C=fe(y||f,l),z,j,A;if((A=r.call(e,new oe("beforestart",{sourceEvent:f,target:u,identifier:E,active:w,x:C[0],y:C[1],dx:0,dy:0,dispatch:B}),S))!=null)return z=A.x-C[0]||0,j=A.y-C[1]||0,function W(L,q,F){var $=C,_;switch(L){case"start":x[E]=W,_=w++;break;case"end":delete x[E],--w;case"drag":C=fe(F||q,l),_=w;break}B.call(L,e,new oe(L,{sourceEvent:q,subject:A,target:u,identifier:E,active:_,x:C[0]+z,y:C[1]+j,dx:C[0]-$[0],dy:C[1]-$[1],dispatch:B}),S)}}return u.filter=function(e){return arguments.length?(t=typeof e=="function"?e:J(!!e),u):t},u.container=function(e){return arguments.length?(o=typeof e=="function"?e:J(e),u):o},u.subject=function(e){return arguments.length?(r=typeof e=="function"?e:J(e),u):r},u.touchable=function(e){return arguments.length?(s=typeof e=="function"?e:J(!!e),u):s},u.on=function(){var e=p.on.apply(p,arguments);return e===p?u:e},u.clickDistance=function(e){return arguments.length?(k=(e=+e)*e,u):Math.sqrt(k)},u}const Be=Re({slots:{base:`text-foreground
    flex
    w-full
    h-full
    justify-center
    rounded-lg
    bg-card`,svg:`w-full
    h-full
    flex
    items-center`}}),Xe=200,Ye=100,ge={delay:1,attack:1,hold:1,decay:1,release:1},_e="var(--echo-primary)",Ge=3,Ve="var(--echo-secondary)",$e=6,Ke=Ee((t,o)=>{const{data:r,limits:s=ge,lineColor:x=_e,lineWidth:p=Ge,nodeColor:w=Ve,nodeSize:b=$e,onChange:R,onChangeEnd:g,...D}=t;we(o,()=>k.current);const k=Z(null),u=Z(null),P=Z(null),m=Z(null),[T,X]=te(!1),[i,O]=te(r),U=I(()=>v(i.delay||0),[i]),e=I(()=>v(i.attack),[i]),l=I(()=>v(i.hold||0),[i]),f=I(()=>v(i.decay),[i]),S=I(()=>v(i.sustain),[i]),E=I(()=>v(i.release),[i]),[y,B]=te([{type:"delay",x:U,y:0},{type:"attack",x:U+e,y:1},{type:"hold",x:U+e+l,y:1},{type:"sustain",x:U+e+l+f,y:S},{type:"release",x:U+e+l+f+E,y:0}]),C=I(()=>y[0],[y]),z=I(()=>y[1],[y]),j=I(()=>y[2],[y]),A=I(()=>y[3],[y]),W=I(()=>y[4],[y]),L=I(()=>{const c={...ge,...s};return r.delay===void 0&&(c.delay=0),r.hold===void 0&&(c.hold=0),c},[s]),q=Ae(k,Xe,Ye,()=>{F(),$(),_()},!0,i);ae(()=>{ve()},[y]),ae(()=>{O(r),De(),F(),$(),_()},[r,s]);const F=()=>{const{width:c,height:d}=q.current;P.current=de().domain([0,L.delay+L.attack+L.hold+L.decay+L.release]).range([0+2,c-2]),m.current=de().domain([0,1]).range([d-2,2])},$=()=>{const c=Y(u.current);c.selectAll("path.echo-path-line").remove();const d=Te().x(a=>P.current(a.x)).y(a=>m.current(a.y));for(let a=0;a<y.length-1;a++){const H=[y[a],y[a+1]];c.append("path").data([H]).attr("class","echo-path-line").attr("d",d).attr("fill","none").attr("stroke",x).attr("stroke-width",p)}},_=()=>{const c=Y(u.current);c.selectAll("circle.echo-circle-node").remove(),c.selectAll("circle").data(y.filter(d=>Object.keys(i).includes(d.type))).enter().append("circle").attr("class",`echo-circle-node ${T?"cursor-grabbing":"cursor-pointer"}`).attr("type",d=>d.type).attr("cx",d=>P.current(d.x)).attr("cy",d=>m.current(d.y)).attr("fill","var(--echo-card)").attr("r",b).attr("stroke",w).attr("stroke-width",3),c.selectAll("circle.echo-circle-node").call(Ue().on("start",ye).on("drag",xe).on("end",be))},ye=(c,d)=>{d.initialX=d.x,d.initialY=d.y,X(!0)},be=()=>{X(!1),g&&g(i)},xe=(c,d)=>{let a=v(d.initialX+P.current.invert(c.x)),H=v(m.current.invert(m.current(d.initialY)+c.y));switch(d.type){case"delay":H=0,a=Math.min(a,L.delay),a=Math.max(a,0),C.x=a,z.x=a+e,j.x=a+e+l,A.x=a+e+l+f,W.x=a+e+l+f+E;break;case"attack":H=1,a=Math.min(a,C.x+L.attack),a=Math.max(a,C.x),z.x=a,j.x=a+l,A.x=a+l+f,W.x=a+l+f+E;break;case"hold":H=1,a=Math.min(a,z.x+L.hold),a=Math.max(a,z.x),j.x=a,A.x=a+f,W.x=a+f+E;break;case"sustain":H=Math.max(Math.min(H,1),0),a=Math.min(a,j.x+L.decay),a=Math.max(a,j.x),A.x=a,W.x=a+E;break;case"release":H=0,a=Math.min(a,A.x+L.release),a=Math.max(a,A.x),W.x=a;break}d.x=a,d.y=H,B(ee=>ee.map(ue=>ue.type===d.type?d:ue))},ve=()=>{const c={delay:v(C.x),attack:v(z.x-C.x),hold:v(j.x-z.x),decay:v(A.x-j.x),sustain:v(A.y),release:v(W.x-A.x)};r.delay===void 0&&(c==null||delete c.delay),r.hold===void 0&&(c==null||delete c.hold),O(c),R&&R(c)},De=()=>{const c=v(r.delay||0),d=v(r.attack),a=v(r.hold||0),H=v(r.decay),ee=v(r.sustain),ie=v(r.release);C.x=c,z.x=c+d,j.x=c+d+a,A.x=c+d+a+H,A.y=ee,W.x=c+d+a+H+ie};ae(()=>{T?document.getElementsByTagName("body")[0].style.cursor="grabbing":(Y(u.current).selectAll("circle.echo-circle-node").attr("class","echo-circle-node cursor-pointer"),document.getElementsByTagName("body")[0].style.cursor="")},[T]);const{base:ke,svg:Se}=Be();return n("div",{ref:k,...D,className:he(ke(),D.className),children:n("svg",{ref:u,className:he(Se())})})}),Q=Ke;Q.displayName="EchoUI.Envelope";const qe=()=>{const t={attack:.6,decay:.2,sustain:.8,release:.2},[o,r]=h.useState({...t}),[s,x]=h.useState(t.attack),[p,w]=h.useState(t.decay),[b,R]=h.useState(t.sustain),[g,D]=h.useState(t.release),[k,u]=h.useState(!1);h.useEffect(()=>{r({attack:s,decay:p,sustain:b,release:g})},[s,p,b,g]);const P=O=>{x(O.attack),w(O.decay),R(O.sustain),D(O.release)},m=h.useRef(),T=h.useRef();return V("section",{className:"flex flex-col items-center w-full",children:[n(ce,{className:"mb-5 cursor-grab",toggled:k,onMouseDown:()=>{u(!0),m.current=new se({attack:s,decay:p,sustain:b,release:g}).toDestination(),T.current=new re().connect(m.current).start(),m.current.triggerAttack()},onMouseUp:()=>{u(!1),m.current&&(m.current.triggerRelease(),setTimeout(()=>{!m.current||!T.current||(T.current.stop(),T.current.dispose(),m.current.dispose())},g*1e3))},children:n(Le,{className:"w-4 h-4"})}),n(Q,{data:o,onChange:P}),V(M.Group,{className:"gap-8 mt-5 w-full justify-center",trackWidth:2,size:32,max:1,min:0,pointerHeight:5,pointerWidth:3,rotationRange:360,step:.01,sensitivity:5,children:[n(M,{bottomLabel:"Attack",value:s,onChange:x}),n(M,{bottomLabel:"Decay",value:p,onChange:w}),n(M,{bottomLabel:"Sustain",value:b,onChange:R}),n(M,{bottomLabel:"Release",value:g,onChange:D})]})]})},Fe=()=>{const t={attack:0,hold:1,decay:0,sustain:0,release:0},[o,r]=h.useState({...t}),[s,x]=h.useState(t.attack),[p,w]=h.useState(t.hold),[b,R]=h.useState(t.decay),[g,D]=h.useState(t.sustain),[k,u]=h.useState(t.release);h.useEffect(()=>{r({attack:s,decay:b,hold:p,sustain:g,release:k})},[s,p,b,g,k]);const P=i=>{x(i.attack),R(i.decay),w(i.hold),D(i.sustain),u(i.release)},m=h.useRef(),T=h.useRef();return V("section",{className:"flex flex-col items-center",children:[n(ce,{className:"mb-5",onMouseDown:()=>{m.current=new se({attack:s,decay:b,sustain:g,release:k}).toDestination(),T.current=new re().connect(m.current).start(),m.current.triggerAttack(),m.current.triggerRelease(`+${s+p+b}}`)},children:n(pe,{className:"w-4 h-4"})}),n(Q,{data:o,onChange:P}),V(M.Group,{className:"gap-8 mt-5 w-full justify-center",trackWidth:2,size:32,max:1,min:0,pointerHeight:5,pointerWidth:3,rotationRange:360,step:.01,sensitivity:5,children:[n(M,{bottomLabel:"Attack",value:s,onChange:x}),n(M,{bottomLabel:"Hold",value:p,onChange:w}),n(M,{bottomLabel:"Decay",value:b,onChange:R}),n(M,{bottomLabel:"Sustain",value:g,onChange:D}),n(M,{bottomLabel:"Release",value:k,onChange:u})]})]})},Ze=()=>{const t={delay:.5,attack:.6,decay:.6,sustain:.4,release:.8},[o,r]=h.useState({...t}),[s,x]=h.useState(t.delay),[p,w]=h.useState(t.attack),[b,R]=h.useState(t.decay),[g,D]=h.useState(t.sustain),[k,u]=h.useState(t.release);h.useEffect(()=>{r({delay:s,attack:p,decay:b,sustain:g,release:k})},[s,p,b,g,k]);const P=i=>{x(i.delay),w(i.attack),R(i.decay),D(i.sustain),u(i.release)},m=h.useRef(),T=h.useRef();return V("section",{className:"flex flex-col items-center",children:[n(ce,{className:"mb-5",onMouseDown:()=>{m.current=new se({attack:p,decay:b,sustain:g,release:k}).toDestination(),T.current=new re().connect(m.current).start(),m.current.triggerAttack(`+${s||0}`),m.current.triggerRelease(`+${s+p+b}}`)},children:n(pe,{className:"w-4 h-4"})}),n(Q,{data:o,onChange:P}),V(M.Group,{className:"gap-8 mt-5 w-full justify-center",trackWidth:2,size:32,max:1,min:0,pointerHeight:5,pointerWidth:3,rotationRange:360,step:.01,sensitivity:5,children:[n(M,{bottomLabel:"Delay",value:s,onChange:x}),n(M,{bottomLabel:"Attack",value:p,onChange:w}),n(M,{bottomLabel:"Decay",value:b,onChange:R}),n(M,{bottomLabel:"Sustain",value:g,onChange:D}),n(M,{bottomLabel:"Release",value:k,onChange:u})]})]})},it=()=>n(le,{code:"<EnvelopeDefault />",scope:{EnvelopeDefault:qe},type:"link",url:"https://github.com/codeacme17/echo-ui/blob/main/docs/src/components/Example/EnvelopeDefault.tsx"}),ut=()=>n(le,{code:"<EnvelopeAHDSR />",scope:{EnvelopeAHDSR:Fe},type:"link",url:"https://github.com/codeacme17/echo-ui/blob/main/docs/src/components/Example/EnvelopeAHDSR.tsx"}),dt=()=>n(le,{code:"<EnvelopeDADSR />",scope:{EnvelopeDADSR:Ze},type:"link",url:"https://github.com/codeacme17/echo-ui/blob/main/docs/src/components/Example/EnvelopeDADSR.tsx"}),ht=()=>n(Me,{data:[{attribute:"data*",description:"The ADSP data to be displayed(required)",type:n(N,{children:"EnvelopeData"}),default:"-"},{attribute:"limits",description:"The limits of each ADSP data",type:n(N,{children:"EnvelopeLimits"}),default:n(N,{children:"0.75rem"})},{attribute:"lineColor",description:"Color of the line",type:n(N,{children:"string"}),default:n(N,{children:"var(--echo-primary)"})},{attribute:"lineWidth",description:"Width of the line",type:n(N,{children:"number"}),default:n(N,{children:"3"})},{attribute:"nodeColor",description:"Color of the node",type:n(N,{children:"string"}),default:n(N,{children:"var(--echo-secondary)"})},{attribute:"nodeSize",description:"Size of the node",type:n(N,{children:"number"}),default:n(N,{children:"6"})},{attribute:"onChange",description:"The callback function when data changed",type:n(N,{children:"(data: EnvelopeData) => void"}),default:"-"},{attribute:"onChangeEnd",description:"The callback function when data changed ended",type:n(N,{children:"(data: EnvelopeData) => void"}),default:"-"}]});export{ut as A,it as D,ht as E,dt as a};
