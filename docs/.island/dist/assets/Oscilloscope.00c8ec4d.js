<<<<<<<< HEAD:docs/.island/dist/assets/Oscilloscope.00c8ec4d.js
import{d as w,c as S,U as L,A as _,a as d}from"./index.b2cccce0.js";import*as T from"react";import{forwardRef as k,useImperativeHandle as H,useRef as p,useEffect as N,useState as I,useCallback as x}from"react";import{jsx as t,jsxs as W}from"react/jsx-runtime";import{u as j,a as B}from"./usePlayer.db8858d9.js";import"./index.6eef3859.js";import{s as U,l as G}from"./log.83f32a09.js";import{A as M}from"./Analyser.9e774fcc.js";import{l as P}from"./transform.3e3dfeca.js";import{s as q}from"./index.93441784.js";import{u as z,l as V}from"./line.c32ceb13.js";import{n as Y,c as Z}from"./natural.7ea22fd8.js";import{B as $}from"./index.6b8ad651.js";const J=q({slots:{base:`text-foreground
========
import{d as w,c as S,U as L,A as _,a as d}from"./index.2440eb3f.js";import*as T from"react";import{forwardRef as k,useImperativeHandle as H,useRef as p,useEffect as N,useState as I,useCallback as x}from"react";import{jsx as t,jsxs as W}from"react/jsx-runtime";import{u as j,a as B}from"./usePlayer.db8858d9.js";import"./index.6eef3859.js";import{s as U,l as G}from"./log.83f32a09.js";import{A as M}from"./Analyser.9e774fcc.js";import{l as P}from"./transform.3e3dfeca.js";import{s as q}from"./index.93441784.js";import{u as z,l as V}from"./line.c32ceb13.js";import{n as Y,c as Z}from"./natural.7ea22fd8.js";import{B as $}from"./index.fe61fadf.js";const J=q({slots:{base:`text-foreground
>>>>>>>> main:docs/.island/dist/assets/Oscilloscope.f1db0d3b.js
    flex
    justify-center
    rounded-lg
    bg-card`,svg:`w-full
    h-full
    flex
    items-center`}}),K=400,Q=200,X=[-2,2],ee=3,te="var(--echo-primary)",re=k((i,o)=>{const{data:r=[],amplitudeRange:f=X,lineColor:n=te,lineWidth:s=ee,...u}=i;H(o,()=>a.current);const a=p(null),c=p(null),l=p(null),m=p(null),h=p(0),g=z(a,K,Q,()=>{v(),y()});N(()=>{y()},[r]),N(()=>{h.current=r.length,v()},[r.length]);const v=()=>{const{width:e,height:b}=g.current;l.current=P().domain([0,h.current]).range([0,e]),m.current=P().domain(f).range([b,0])},y=()=>{const e=U(c.current);if(e.selectAll("g.echo-g-line").remove(),!r.length)return;const{width:b,height:E}=g.current,D=e.append("g").attr("class","echo-g-line").attr("width",b).attr("height",E),F=V().x(R=>w(l.current,R.index,-100)).y(R=>w(m.current,R.amplitude,-100)).curve(Y).curve(Z.alpha(.5));D.selectAll("path.echo-path-line").data([r]).join("path").attr("class","echo-path-line").attr("d",F).attr("stroke",n).attr("stroke-width",s).attr("fill","none")},{base:A,svg:O}=J();return t("div",{...u,ref:a,className:S(A(),u.className),style:u.style,children:t("svg",{ref:c,className:S(O())})})}),C=re;C.displayName="EchoUI.Oscilloscope";const se=1024,oe=(i={})=>{const{fftSize:o=se,onReady:r,onError:f}=i,n=p(0),s=p(null),[u,a]=I([]),[c,l]=I(!1),[m,h]=I("");N(()=>()=>{var e;(e=s.current)==null||e.dispose(),O()},[]);const g=x(e=>{l(!0),h(e),G.error(e),f&&f()},[]),v=x(()=>{try{s.current=new M("waveform",o),r&&r()}catch(e){g(e)}},[o]),y=()=>{if(!s.current||c)return;const e=s.current.getValue();if(e instanceof Float32Array){const b=Array.from(e).map((E,D)=>({index:D,amplitude:E}));a(b)}},A=x(()=>{if(!(!s.current||c))try{n.current=requestAnimationFrame(A),y()}catch(e){g(e)}},[]),O=x(()=>{!n.current||(a([]),cancelAnimationFrame(n.current))},[]);return{init:v,analyser:s,data:u,getData:y,observer:A,cancelObserve:O,error:c,errorMessage:m}},ne=()=>{const i="/audios/loop-5.mp3",{audioBuffer:o,fetchAudio:r}=j({url:i}),{init:f,isPlaying:n,play:s,pause:u}=B(),{observer:a,cancelObserve:c,analyser:l,init:m,data:h}=oe();return T.useEffect(()=>{r(),m()},[]),T.useEffect(()=>{!o||!l.current||f(o,[l.current])},[o,l.current]),W("section",{className:"flex flex-col items-center gap-2 w-full",children:[t(C,{className:"w-full",data:h,amplitudeRange:[-5,5]}),t($,{onClick:()=>{n?(u(),c()):(s(),a())},toggled:n,children:n?"Stop":"Start"})]})},be=()=>t(L,{code:"<OscilloscopeDefault />",scope:{OscilloscopeDefault:ne},type:"link",url:"https://github.com/codeacme17/echo-ui/blob/main/docs/src/components/Example/OscilloscopeDefault.tsx"}),ve=()=>t(_,{data:[{attribute:"data*",description:"Array data passed to the oscilloscope(required)",type:t(d,{children:"OscilloscopeDataPoint[]"}),default:"-"},{attribute:"amplitudeRange",description:"Amplitude range, this property specifies the range of the Y-axis",type:t(d,{children:"[number, number]"}),default:t(d,{children:"[-2, 2]"})},{attribute:"lineColor",description:"Color of the oscilloscope's line",type:t(d,{children:"string"}),default:t(d,{children:"'var(--echo-primary)'"})},{attribute:"lineWidth",description:"Width of the oscilloscope's line",type:t(d,{children:"number"}),default:t(d,{children:"3"})}]});export{be as D,ve as O};
