import{jsxs as et,jsx as $}from"react/jsx-runtime";import{createContext as yt,forwardRef as nt,useContext as xt,useEffect as k,useState as V,useRef as T,useCallback as kt,useMemo as ot,isValidElement as Tt}from"react";import{l as _t}from"./transform.3e3dfeca.js";import{v as g,c as m,h as rt}from"./index.b2cccce0.js";import{_ as Nt}from"./assertion.e9357fda.js";import{l as w,s as It}from"./log.83f32a09.js";import{s as at}from"./index.93441784.js";import{u as Kt}from"./usePropsWithGroup.a30eaab0.js";import{u as Vt}from"./useCommandAltClick.cec7174c.js";const st=yt(null),wt=st.Provider,Dt=({value:a,min:h,max:s,rotationRange:i})=>{if(!!Nt)return a>s&&w.warn(`Knob - value(${a}) is higher than max(${s})`),a<h&&w.warn(`Knob - value(${a}) is lower than min(${h})`),i>360&&w.warn(`Knob - rotationRange(${i}) is higher than max(360)`),i<90&&w.warn(`Knob - rotationRange(${i}) is lower than min(90)`),!0},Ot=at({slots:{base:"group inline-flex flex-col items-center",button:"cursor-pointer bg-muted",progress:`absolute
    top-0
    left-0
    right-full
    rounded-full
    w-full
    h-full`,trigger:`w-full
    h-full
    border-2
    border-transparent
    rounded-full
    bg-button`,triggerPointer:`absolute 
    shadow-sm
    shadow-muted
    rounded-sm
    origin-bottom
    left-1/2 
    -translate-x-1/2`,topLabel:"text-muted-foreground select-none font-bold mb-1.5",bottomLabel:"text-sm select-none text-opacity-80 mt-1.5 text-muted-foreground"},defaultVariants:{isDragging:!1,disabled:!1},variants:{isDragging:{true:{button:"cursor-grabbing"}},disabled:{true:{button:"pointer-events-none"}}}}),Pt=at({base:"inline-flex gap-5"}),Gt=0,At=-10,St=10,Wt=1,Bt=270,Ht=1,Yt="4rem",Ft="0.5rem",Mt="var(--echo-input)",Ut="var(--echo-button)",jt="var(--echo-primary)",qt="0.375rem",zt="1rem",Xt="var(--echo-primary)",Zt=nt((a,h)=>{var Q,tt;const s=xt(st),i=!!s,{value:v=Gt,min:e=At,max:o=St,step:R=Wt,bilateral:n=!1,disabled:l=!1,sensitivity:_=Ht,rotationRange:D=Bt,size:E=Yt,trackWidth:O=Ft,trackColor:L=Mt,buttonColor:P=Ut,progressColor:N=jt,pointerWidth:G=qt,pointerHeight:A=zt,pointerColor:b=Xt,topLabel:S,bottomLabel:ct,classNames:c,styles:u,onChange:p,onChangeEnd:M,...W}=Kt(a,s);k(()=>{Dt(a)},[]);const[y,I]=V(g(v,e,o)),[K,U]=V(!1),[B,ut]=V("negative"),r=g(D,90,360),H=T(_t().domain([e,o]).range([0,r])),[d,dt]=V(H.current(g(v,e,o))),j=T(y),q=T(null),Y=T(y),F=T(0);k(()=>{const t=g(v,e,o);I(t)},[v,e,o]),k(()=>{if(l)return;const t=g(y,e,o);dt(H.current(t))},[y,e,o,H]),k(()=>{n&&ut(d<r/2?"negative":"positive"),bt()},[n,d,r]);const z=Vt(()=>{I(n?rt(e,o):e),p==null||p(g(n?rt(e,o):e,e,o))}),gt=t=>{l||(t.stopPropagation(),U(!0),Y.current=y,F.current=t.clientY,document.addEventListener("mousemove",X),document.addEventListener("mouseup",Z),z(t))},X=t=>{t.preventDefault(),requestAnimationFrame(()=>mt(t))},Z=t=>{t.preventDefault(),t.stopPropagation(),U(!1),M&&M(j.current),document.removeEventListener("mousemove",X),document.removeEventListener("mouseup",Z),z(t)},mt=kt(t=>{const x=(F.current-t.clientY)*(_/10)*R;let f=Y.current+x;f=parseFloat((Math.round(f/R)*R).toFixed(10)),f=g(f,e,o),j.current=f,I(f),p==null||p(g(f,e,o))},[F,Y,_,R,e,o,p]);k(()=>{K?document.getElementsByTagName("body")[0].style.cursor="grabbing":document.getElementsByTagName("body")[0].style.cursor=""},[K]);const bt=()=>{requestAnimationFrame(()=>It(q.current).style("transform",`rotate(${d}deg)`))},pt=ot(()=>{const t=l?"var(--echo-muted)":N;if(!n)return`conic-gradient(${t} 0% ${d}deg, transparent ${d}deg 100%)`;if(B==="negative"){const C=r/2+d+360-r,x=360-d;return`conic-gradient(transparent ${C}deg, ${t} 0% ${x}deg)`}else{const C=d-r/2;return`conic-gradient(${t} ${C}deg, transparent 0% 100%)`}},[d,n,N,B,r,l]),ft=ot(()=>{const t=r/2;return`conic-gradient(
      ${L} ${t}deg, 
      transparent 0% ${360-t}deg, 
      ${L} ${t}deg)`},[L,r]),J=(t,C,x)=>!t&&t!==0?null:Tt(t)?t:$("div",{className:x,style:C,children:`${t}`}),{base:ht,button:vt,progress:Rt,trigger:Ct,triggerPointer:$t,topLabel:Et,bottomLabel:Lt}=Ot({disabled:l,isDragging:K});return et("div",{...W,ref:h,"data-dragging":K,"data-disabled":l,"data-bilateral":n,"data-direction":B,className:m(ht(),i&&((Q=s.classNames)==null?void 0:Q.knob),W.className),style:{...i&&((tt=s.styles)==null?void 0:tt.knob),...W.style,minWidth:E},children:[J(S,u==null?void 0:u.topLabel,m(Et(),c==null?void 0:c.topLabel)),et("div",{onMouseDown:gt,className:m(vt(),c==null?void 0:c.button),style:{...u==null?void 0:u.button,padding:O,width:E,height:E,position:"relative",userSelect:"none",borderRadius:"100%",background:ft},children:[$("div",{className:m(Rt()),style:{rotate:n?"0deg":`-${r/2}deg`,background:pt}}),$("div",{ref:q,className:m(Ct()),style:{rotate:`-${r/2}deg`,backgroundColor:P},role:"slider",children:$("div",{className:m($t()),style:{width:G,height:A,backgroundColor:l?"var(--echo-muted)":b}})})]}),J(ct,u==null?void 0:u.bottomLabel,m(Lt(),c==null?void 0:c.bottomLabel))]})}),it=nt((a,h)=>{const{disabled:s,progressColor:i,pointerColor:v,size:e,trackWidth:o,trackColor:R,buttonColor:n,pointerWidth:l,pointerHeight:_,bilateral:D,sensitivity:E,rotationRange:O,step:L,min:P,max:N,classNames:G,styles:A,...b}=a,S={disabled:s,progressColor:i,pointerColor:v,size:e,trackWidth:o,trackColor:R,buttonColor:n,pointerWidth:l,pointerHeight:_,bilateral:D,sensitivity:E,rotationRange:O,step:L,min:P,max:N,classNames:G,styles:A,...b};return $(wt,{value:S,children:$("div",{...b,ref:h,className:m(Pt(),b.className),style:b.style,children:b.children})})}),lt=Zt;lt.displayName="EchoUI.Knob";it.displayName="EchoUI.KnobGroup";lt.Group=it;export{lt as K};
