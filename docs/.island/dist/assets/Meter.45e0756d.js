import{T as g,o as e,w as m,g as c}from"./index.5a6550a4.js";import{A as i}from"./Analyser.93bf318f.js";class t extends g{constructor(){super(e(t.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new i({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class n extends t{constructor(){super(e(n.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;const s=e(n.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new i({context:this.context,size:256,type:"waveform",channels:s.channels}),this.smoothing=s.smoothing,this.normalRange=s.normalRange}static getDefaults(){return Object.assign(t.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return m("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){const s=this._analyser.getValue(),a=(this.channels===1?[s]:s).map(o=>{const h=o.reduce((u,r)=>u+r*r,0),l=Math.sqrt(h/o.length);return this._rms=Math.max(l,this._rms*this.smoothing),this.normalRange?this._rms:c(this._rms)});return this.channels===1?a[0]:a}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}export{n as M};
