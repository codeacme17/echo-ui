import{A as se,O as re}from"./index.6eef3859.js";import*as h from"react";import{forwardRef as Se,useImperativeHandle as Ee,useRef as Z,useState as te,useMemo as z,useEffect as ae}from"react";import{jsx as o,jsxs as _}from"react/jsx-runtime";import{B as ce}from"./index.fe61fadf.js";import{c as ge}from"./CodeBlock.d8e569ad.js";import{d as we,l as de}from"./transform.3e3dfeca.js";import{f as D,c as he,U as le,A as Me,a as O}from"./index.2440eb3f.js";import{s as Re}from"./index.93441784.js";import{u as Ae,l as Ce}from"./line.c32ceb13.js";import{s as X}from"./log.83f32a09.js";import{K as A}from"./index.79cba356.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=ge("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=ge("Hand",[["path",{d:"M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0",key:"aigmz7"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2",key:"1n6bmn"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8",key:"a9iiix"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]]);function Te(t){let n;for(;n=t.sourceEvent;)t=n;return t}function me(t,n){if(t=Te(t),n===void 0&&(n=t.currentTarget),n){var r=n.ownerSVGElement||n;if(r.createSVGPoint){var s=r.createSVGPoint();return s.x=t.clientX,s.y=t.clientY,s=s.matrixTransform(n.getScreenCTM().inverse()),[s.x,s.y]}if(n.getBoundingClientRect){var y=n.getBoundingClientRect();return[t.clientX-y.left-n.clientLeft,t.clientY-y.top-n.clientTop]}}return[t.pageX,t.pageY]}const Ne={passive:!1},q={capture:!0,passive:!1};function ne(t){t.stopImmediatePropagation()}function Y(t){t.preventDefault(),t.stopImmediatePropagation()}function Pe(t){var n=t.document.documentElement,r=X(t).on("dragstart.drag",Y,q);"onselectstart"in n?r.on("selectstart.drag",Y,q):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function He(t,n){var r=t.document.documentElement,s=X(t).on("dragstart.drag",null);n&&(s.on("click.drag",Y,q),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in r?s.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}const J=t=>()=>t;function oe(t,{sourceEvent:n,subject:r,target:s,identifier:y,active:f,x:w,y:g,dx:M,dy:m,dispatch:x}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:y,enumerable:!0,configurable:!0},active:{value:f,enumerable:!0,configurable:!0},x:{value:w,enumerable:!0,configurable:!0},y:{value:g,enumerable:!0,configurable:!0},dx:{value:M,enumerable:!0,configurable:!0},dy:{value:m,enumerable:!0,configurable:!0},_:{value:x}})}oe.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Ie(t){return!t.ctrlKey&&!t.button}function je(){return this.parentNode}function ze(t,n){return n==null?{x:t.x,y:t.y}:n}function Oe(){return navigator.maxTouchPoints||"ontouchstart"in this}function We(){var t=Ie,n=je,r=ze,s=Oe,y={},f=we("start","drag","end"),w=0,g,M,m,x,v=0;function i(e){e.on("mousedown.drag",L).filter(s).on("touchstart.drag",k).on("touchmove.drag",R,Ne).on("touchend.drag touchcancel.drag",P).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function L(e,l){if(!(x||!t.call(this,e,l))){var S=W(this,n.call(this,e,l),e,l,"mouse");!S||(X(e.view).on("mousemove.drag",p,q).on("mouseup.drag",T,q),Pe(e.view),ne(e),m=!1,g=e.clientX,M=e.clientY,S("start",e))}}function p(e){if(Y(e),!m){var l=e.clientX-g,S=e.clientY-M;m=l*l+S*S>v}y.mouse("drag",e)}function T(e){X(e.view).on("mousemove.drag mouseup.drag",null),He(e.view,m),Y(e),y.mouse("end",e)}function k(e,l){if(!!t.call(this,e,l)){var S=e.changedTouches,b=n.call(this,e,l),d=S.length,B,N;for(B=0;B<d;++B)(N=W(this,b,e,l,S[B].identifier,S[B]))&&(ne(e),N("start",e,S[B]))}}function R(e){var l=e.changedTouches,S=l.length,b,d;for(b=0;b<S;++b)(d=y[l[b].identifier])&&(Y(e),d("drag",e,l[b]))}function P(e){var l=e.changedTouches,S=l.length,b,d;for(x&&clearTimeout(x),x=setTimeout(function(){x=null},500),b=0;b<S;++b)(d=y[l[b].identifier])&&(ne(e),d("end",e,l[b]))}function W(e,l,S,b,d,B){var N=f.copy(),E=me(B||S,l),U,C,H;if((H=r.call(e,new oe("beforestart",{sourceEvent:S,target:i,identifier:d,active:w,x:E[0],y:E[1],dx:0,dy:0,dispatch:N}),b))!=null)return U=H.x-E[0]||0,C=H.y-E[1]||0,function I(G,V,F){var $=E,K;switch(G){case"start":y[d]=I,K=w++;break;case"end":delete y[d],--w;case"drag":E=me(F||V,l),K=w;break}N.call(G,e,new oe(G,{sourceEvent:V,subject:H,target:i,identifier:d,active:K,x:E[0]+U,y:E[1]+C,dx:E[0]-$[0],dy:E[1]-$[1],dispatch:N}),b)}}return i.filter=function(e){return arguments.length?(t=typeof e=="function"?e:J(!!e),i):t},i.container=function(e){return arguments.length?(n=typeof e=="function"?e:J(e),i):n},i.subject=function(e){return arguments.length?(r=typeof e=="function"?e:J(e),i):r},i.touchable=function(e){return arguments.length?(s=typeof e=="function"?e:J(!!e),i):s},i.on=function(){var e=f.on.apply(f,arguments);return e===f?i:e},i.clickDistance=function(e){return arguments.length?(v=(e=+e)*e,i):Math.sqrt(v)},i}const Ue=Re({slots:{base:`text-foreground
    flex
    w-full
    h-full
    justify-center
    rounded-lg
    bg-card`,svg:`w-full
    h-full
    flex
    items-center`}}),Be=200,Xe=100,fe={delay:1,attack:1,hold:1,decay:1,release:1},Ye="var(--echo-primary)",_e=3,Ge="var(--echo-secondary)",Ve=6,$e=Se((t,n)=>{const{data:r,limits:s=fe,lineColor:y=Ye,lineWidth:f=_e,nodeColor:w=Ge,nodeSize:g=Ve,onDataChange:M,...m}=t;Ee(n,()=>x.current);const x=Z(null),v=Z(null),i=Z(null),L=Z(null),[p,T]=te(!1),[k,R]=te(r),P=z(()=>D(k.delay||0),[k]),W=z(()=>D(k.attack),[k]),e=z(()=>D(k.hold||0),[k]),l=z(()=>D(k.decay),[k]),S=z(()=>D(k.sustain),[k]),b=z(()=>D(k.release),[k]),[d,B]=te([{type:"delay",x:P,y:0},{type:"attack",x:P+W,y:1},{type:"hold",x:P+W+e,y:1},{type:"sustain",x:P+W+e+l,y:S},{type:"release",x:P+W+e+l+b,y:0}]),N=z(()=>d[0],[d]),E=z(()=>d[1],[d]),U=z(()=>d[2],[d]),C=z(()=>d[3],[d]),H=z(()=>d[4],[d]),I=z(()=>{const c={...fe,...s};return r.delay===void 0&&(c.delay=0),r.hold===void 0&&(c.hold=0),c},[s]),G=Ae(x,Be,Xe,()=>{V(),F(),$()},!0,k);ae(()=>{xe()},[d]),ae(()=>{R(r),ve(),V(),F(),$()},[r,s]);const V=()=>{const{width:c,height:u}=G.current;i.current=de().domain([0,I.delay+I.attack+I.hold+I.decay+I.release]).range([0+2,c-2]),L.current=de().domain([0,1]).range([u-2,2])},F=()=>{const c=X(v.current);c.selectAll("path.echo-path-line").remove();const u=Ce().x(a=>i.current(a.x)).y(a=>L.current(a.y));for(let a=0;a<d.length-1;a++){const j=[d[a],d[a+1]];c.append("path").data([j]).attr("class","echo-path-line").attr("d",u).attr("fill","none").attr("stroke",y).attr("stroke-width",f)}},$=()=>{const c=X(v.current);c.selectAll("circle.echo-circle-node").remove(),c.selectAll("circle").data(d.filter(u=>Object.keys(k).includes(u.type))).enter().append("circle").attr("class",`echo-circle-node ${p?"cursor-grabbing":"cursor-pointer"}`).attr("type",u=>u.type).attr("cx",u=>i.current(u.x)).attr("cy",u=>L.current(u.y)).attr("fill","var(--echo-card)").attr("r",g).attr("stroke",w).attr("stroke-width",3),c.selectAll("circle.echo-circle-node").call(We().on("start",K).on("drag",be).on("end",ye))},K=(c,u)=>{u.initialX=u.x,u.initialY=u.y,T(!0)},ye=()=>{T(!1)},be=(c,u)=>{let a=D(u.initialX+i.current.invert(c.x)),j=D(L.current.invert(L.current(u.initialY)+c.y));switch(u.type){case"delay":j=0,a=Math.min(a,I.delay),a=Math.max(a,0),N.x=a,E.x=a+W,U.x=a+W+e,C.x=a+W+e+l,H.x=a+W+e+l+b;break;case"attack":j=1,a=Math.min(a,N.x+I.attack),a=Math.max(a,N.x),E.x=a,U.x=a+e,C.x=a+e+l,H.x=a+e+l+b;break;case"hold":j=1,a=Math.min(a,E.x+I.hold),a=Math.max(a,E.x),U.x=a,C.x=a+l,H.x=a+l+b;break;case"sustain":j=Math.max(Math.min(j,1),0),a=Math.min(a,U.x+I.decay),a=Math.max(a,U.x),C.x=a,H.x=a+b;break;case"release":j=0,a=Math.min(a,C.x+I.release),a=Math.max(a,C.x),H.x=a;break}u.x=a,u.y=j,B(ee=>ee.map(ue=>ue.type===u.type?u:ue))},xe=()=>{const c={delay:D(N.x),attack:D(E.x-N.x),hold:D(U.x-E.x),decay:D(C.x-U.x),sustain:D(C.y),release:D(H.x-C.x)};r.delay===void 0&&(c==null||delete c.delay),r.hold===void 0&&(c==null||delete c.hold),R(c),M==null||M(c)},ve=()=>{const c=D(r.delay||0),u=D(r.attack),a=D(r.hold||0),j=D(r.decay),ee=D(r.sustain),ie=D(r.release);N.x=c,E.x=c+u,U.x=c+u+a,C.x=c+u+a+j,C.y=ee,H.x=c+u+a+j+ie};ae(()=>{p?document.getElementsByTagName("body")[0].style.cursor="grabbing":(X(v.current).selectAll("circle.echo-circle-node").attr("class","echo-circle-node cursor-pointer"),document.getElementsByTagName("body")[0].style.cursor="")},[p]);const{base:De,svg:ke}=Ue();return o("div",{ref:x,...m,className:he(De(),m.className),children:o("svg",{ref:v,className:he(ke())})})}),Q=$e;Q.displayName="EchoUI.Envelope";const Ke=()=>{const t={attack:.6,decay:.2,sustain:.8,release:.2},[n,r]=h.useState({...t}),[s,y]=h.useState(t.attack),[f,w]=h.useState(t.decay),[g,M]=h.useState(t.sustain),[m,x]=h.useState(t.release),[v,i]=h.useState(!1);h.useEffect(()=>{r({attack:s,decay:f,sustain:g,release:m})},[s,f,g,m]);const L=P=>{y(P.attack),w(P.decay),M(P.sustain),x(P.release)},p=h.useRef(),T=h.useRef();return _("section",{className:"flex flex-col items-center w-full",children:[o(ce,{className:"mb-5 cursor-grab",toggled:v,onMouseDown:()=>{i(!0),p.current=new se({attack:s,decay:f,sustain:g,release:m}).toDestination(),T.current=new re().connect(p.current).start(),p.current.triggerAttack()},onMouseUp:()=>{i(!1),p.current&&(p.current.triggerRelease(),setTimeout(()=>{!p.current||!T.current||(T.current.stop(),T.current.dispose(),p.current.dispose())},m*1e3))},children:o(Le,{className:"w-4 h-4"})}),o(Q,{data:n,onDataChange:L}),_(A.Group,{className:"gap-8 mt-5 w-full justify-center",trackWidth:2,size:32,max:1,min:0,pointerHeight:5,pointerWidth:3,rotationRange:360,step:.01,sensitivity:5,children:[o(A,{bottomLabel:"Attack",value:s,onChange:y}),o(A,{bottomLabel:"Decay",value:f,onChange:w}),o(A,{bottomLabel:"Sustain",value:g,onChange:M}),o(A,{bottomLabel:"Release",value:m,onChange:x})]})]})},qe=()=>{const t={attack:0,hold:1,decay:0,sustain:0,release:0},[n,r]=h.useState({...t}),[s,y]=h.useState(t.attack),[f,w]=h.useState(t.hold),[g,M]=h.useState(t.decay),[m,x]=h.useState(t.sustain),[v,i]=h.useState(t.release);h.useEffect(()=>{r({attack:s,decay:g,hold:f,sustain:m,release:v})},[s,f,g,m,v]);const L=R=>{y(R.attack),M(R.decay),w(R.hold),x(R.sustain),i(R.release)},p=h.useRef(),T=h.useRef();return _("section",{className:"flex flex-col items-center",children:[o(ce,{className:"mb-5",onMouseDown:()=>{p.current=new se({attack:s,decay:g,sustain:m,release:v}).toDestination(),T.current=new re().connect(p.current).start(),p.current.triggerAttack(),p.current.triggerRelease(`+${s+f+g}}`)},children:o(pe,{className:"w-4 h-4"})}),o(Q,{data:n,onDataChange:L}),_(A.Group,{className:"gap-8 mt-5 w-full justify-center",trackWidth:2,size:32,max:1,min:0,pointerHeight:5,pointerWidth:3,rotationRange:360,step:.01,sensitivity:5,children:[o(A,{bottomLabel:"Attack",value:s,onChange:y}),o(A,{bottomLabel:"Hold",value:f,onChange:w}),o(A,{bottomLabel:"Decay",value:g,onChange:M}),o(A,{bottomLabel:"Sustain",value:m,onChange:x}),o(A,{bottomLabel:"Release",value:v,onChange:i})]})]})},Fe=()=>{const t={delay:.5,attack:.6,decay:.6,sustain:.4,release:.8},[n,r]=h.useState({...t}),[s,y]=h.useState(t.delay),[f,w]=h.useState(t.attack),[g,M]=h.useState(t.decay),[m,x]=h.useState(t.sustain),[v,i]=h.useState(t.release);h.useEffect(()=>{r({delay:s,attack:f,decay:g,sustain:m,release:v})},[s,f,g,m,v]);const L=R=>{y(R.delay),w(R.attack),M(R.decay),x(R.sustain),i(R.release)},p=h.useRef(),T=h.useRef();return _("section",{className:"flex flex-col items-center",children:[o(ce,{className:"mb-5",onMouseDown:()=>{p.current=new se({attack:f,decay:g,sustain:m,release:v}).toDestination(),T.current=new re().connect(p.current).start(),p.current.triggerAttack(`+${s||0}`),p.current.triggerRelease(`+${s+f+g}}`)},children:o(pe,{className:"w-4 h-4"})}),o(Q,{data:n,onDataChange:L}),_(A.Group,{className:"gap-8 mt-5 w-full justify-center",trackWidth:2,size:32,max:1,min:0,pointerHeight:5,pointerWidth:3,rotationRange:360,step:.01,sensitivity:5,children:[o(A,{bottomLabel:"Delay",value:s,onChange:y}),o(A,{bottomLabel:"Attack",value:f,onChange:w}),o(A,{bottomLabel:"Decay",value:g,onChange:M}),o(A,{bottomLabel:"Sustain",value:m,onChange:x}),o(A,{bottomLabel:"Release",value:v,onChange:i})]})]})},lt=()=>o(le,{code:"<EnvelopeDefault />",scope:{EnvelopeDefault:Ke},type:"link",url:"https://github.com/codeacme17/echo-ui/blob/main/docs/src/components/Example/EnvelopeDefault.tsx"}),it=()=>o(le,{code:"<EnvelopeAHDSR />",scope:{EnvelopeAHDSR:qe},type:"link",url:"https://github.com/codeacme17/echo-ui/blob/main/docs/src/components/Example/EnvelopeAHDSR.tsx"}),ut=()=>o(le,{code:"<EnvelopeDADSR />",scope:{EnvelopeDADSR:Fe},type:"link",url:"https://github.com/codeacme17/echo-ui/blob/main/docs/src/components/Example/EnvelopeDADSR.tsx"}),dt=()=>o(Me,{data:[{attribute:"data*",description:"The ADSP data to be displayed(required)",type:o(O,{children:"EnvelopeData"}),default:"-"},{attribute:"limits",description:"The limits of each ADSP data",type:o(O,{children:"EnvelopeLimits"}),default:o(O,{children:"0.75rem"})},{attribute:"lineColor",description:"Color of the line",type:o(O,{children:"string"}),default:o(O,{children:"var(--echo-primary)"})},{attribute:"lineWidth",description:"Width of the line",type:o(O,{children:"number"}),default:o(O,{children:"3"})},{attribute:"nodeColor",description:"Color of the node",type:o(O,{children:"string"}),default:o(O,{children:"var(--echo-secondary)"})},{attribute:"nodeSize",description:"Size of the node",type:o(O,{children:"number"}),default:o(O,{children:"6"})},{attribute:"onDataChange",description:"The callback function when data changed",type:o(O,{children:"(data: EnvelopeData) => void"}),default:"-"}]});export{it as A,lt as D,dt as E,ut as a};
